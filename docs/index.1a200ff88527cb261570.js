(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e,a){r(t,e),e.set(t,a)}function a(t,e){var a=function(t,e,a){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e);return function(t,e){return e.get?e.get.call(t):e.value}(t,a)}function r(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i(t,e,a){return(e=c(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function o(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(e){var a=function(e,a){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(a)?a:String(a)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=o((function t(){s(this,t),this.getRandomInteger=function(t,e){return Math.floor(Math.random()*(e-t)+t)}})),u=o((function t(e){var a=this;s(this,t),i(this,"update",(function(t){a.balance=t,a.draw()})),i(this,"draw",(function(){a.$container.innerText="Your Score: ".concat(a.balance)})),this.$container=e,this.balance=0,this.draw()})),h=new WeakSet,f=function(){function t(e){var a;s(this,t),r(this,a=h),a.add(this),this.$container=e,this.time="00:00",this.timeStart=Date.now(),this.timeNow=this.timeStart,this.draw()}return o(t,[{key:"draw",value:function(){(function(t,e,a){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return a})(this,h,w).call(this),this.$container.innerText="Round Time: ".concat(this.time)}}]),t}();function w(){this.timeNow=Date.now();var t=this.timeNow-this.timeStart,e=Math.floor(t/1e3),a=0;e>=60&&(e-=60*(a=Math.floor(e/60))),a=a<10?"0".concat(a):"".concat(a),e=e<10?"0".concat(e):"".concat(e),this.time="".concat(a,":").concat(e)}var v=o((function t(e,a,r){var n=this;s(this,t),i(this,"draw",(function(){document.querySelector('[x = "'.concat(n.x,'"][y = "').concat(n.y,'"]')).classList.add("tile","tile-"+n.cost),document.querySelector('[x = "'.concat(n.x,'"][y = "').concat(n.y,'"]')).innerText=n.cost})),this.x=e,this.y=a,this.cost=r,this.draw()})),d=o((function t(e,a,r){var n=this;s(this,t),i(this,"generateMatrix",(function(t,e){for(var a=new Array,r=0;r<t;r++){a[r]=new Array;for(var i=0;i<e;i++)a[r][i]=0}return a})),i(this,"draw",(function(){n.$container.innerHTML="";var t=document.createElement("div");t.classList.add("map"),n.$container.appendChild(t);for(var e=n.matrix_height-1;e>=0;e--)for(var a=0;a<n.matrix_width;a++){var r=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",a),r.setAttribute("y",e),t.appendChild(r)}})),this.$container=e,this.matrix_width=a,this.matrix_height=r,this.matrix=this.generateMatrix(this.matrix_width,this.matrix_height),this.draw()})),p=new WeakMap,m=new WeakMap,b=new WeakMap,R=new WeakMap,g=new WeakMap,y=new WeakMap,M=new WeakMap,T=new WeakMap,A=new WeakMap,I=new WeakMap,_=new WeakMap,E=new WeakMap,W=new WeakMap;new(o((function t(){var r=this;s(this,t),i(this,"init",(function(){r.map=new d(r.$MAP_WRAPPER,r.MATRIX_WIDTH,r.MATRIX_HEIGHT),r.score=new u(r.$SCORE_WRAPPER),r.timer=new f(r.$TIMER_WRAPPER),r.tiles=r.map.matrix,a(r,p).call(r),a(r,p).call(r),a(r,b).call(r),r.$DIALOG_WRAPPER.innerHTML="Get 2048!",r.interval=setInterval(r.draw,1e3)})),i(this,"draw",(function(){r.map.draw(),r.score.draw(),r.timer.draw();for(var t=0;t<=3;t++)for(var e=0;e<=3;e++)0!==r.tiles[t][e]&&r.tiles[t][e].draw()})),e(this,p,{writable:!0,value:function(){if(0!==a(r,m).call(r)){for(var t=new Array,e=0;e<r.MATRIX_WIDTH;e++)for(var i=0;i<r.MATRIX_HEIGHT;i++)0===r.tiles[e][i]&&t.push([e,i]);var n=r.support.getRandomInteger(0,t.length),o=2*r.support.getRandomInteger(1,3),c=t[n][0],s=t[n][1];r.tiles[c][s]=new v(c,s,o)}}}),e(this,m,{writable:!0,value:function(){for(var t=0,e=0;e<r.MATRIX_WIDTH;e++)for(var a=0;a<r.MATRIX_HEIGHT;a++)0===r.tiles[e][a]&&t++;return t}}),e(this,b,{writable:!0,value:function(){for(var t=0,e=0;e<r.MATRIX_WIDTH;e++)for(var a=0;a<r.MATRIX_HEIGHT;a++)0!==r.tiles[e][a]&&(t+=r.tiles[e][a].cost);r.score.update(t)}}),e(this,R,{writable:!0,value:function(){for(var t=0,e=0;e<r.MATRIX_WIDTH;e++)for(var a=0;a<r.MATRIX_HEIGHT;a++)0===r.tiles[e][a]&&t++,a<3&&r.tiles[e][a].cost===r.tiles[e][a+1].cost&&t++,e<3&&r.tiles[e][a].cost===r.tiles[e+1][a].cost&&t++;0===t&&(r.$DIALOG_WRAPPER.innerText="Game Over!",clearInterval(r.interval))}}),e(this,g,{writable:!0,value:function(){for(var t=0;t<r.MATRIX_WIDTH;t++)for(var e=0;e<r.MATRIX_HEIGHT;e++)0!==r.tiles[t][e]&&(r.tiles[t][e].x=t,r.tiles[t][e].y=e)}}),e(this,y,{writable:!0,value:function(t){for(var e=0;e<t.length;e++)0===t[e]&&(t.splice(e,1),e--);t.length>1&&t.forEach((function(e,a){void 0!==t[a-1]&&e.cost===t[a-1].cost&&(t[a-1].cost*=2,t.splice(a,1))}));for(var a=1;a<=4;a++)4!=t.length&&t.push(0);return t}}),e(this,M,{writable:!0,value:function(t){for(var e=0,i=0;i<=3;i++){var n=[],o=[];switch(t){case"Up":for(var c=3;c>=0;c--)n.push(r.tiles[i][c]),o.push(r.tiles[i][c]);break;case"Down":for(var s=0;s<=3;s++)n.push(r.tiles[i][s]),o.push(r.tiles[i][s]);break;case"Left":for(var l=0;l<=3;l++)n.push(r.tiles[l][i]),o.push(r.tiles[l][i]);break;case"Right":for(var u=3;u>=0;u--)n.push(r.tiles[u][i]),o.push(r.tiles[u][i])}n=a(r,y).call(r,n);for(var h=0;h<=n.length;h++)n[h]!==o[h]&&e++;switch(t){case"Up":for(var f=3;f>=0;f--)r.tiles[i][f]=n.shift();break;case"Down":for(var w=0;w<=3;w++)r.tiles[i][w]=n.shift();break;case"Left":for(var v=0;v<=3;v++)r.tiles[v][i]=n.shift();break;case"Right":for(var d=3;d>=0;d--)r.tiles[d][i]=n.shift()}}a(r,g).call(r),r.draw(),e>0&&a(r,p).call(r),r.draw(),a(r,b).call(r),a(r,R).call(r)}}),e(this,T,{writable:!0,value:function(){window.addEventListener("keydown",(function(t){"ArrowUp"===t.code||"KeyW"===t.code?a(r,M).call(r,"Up"):"ArrowDown"===t.code||"KeyS"===t.code?a(r,M).call(r,"Down"):"ArrowLeft"===t.code||"KeyA"===t.code?a(r,M).call(r,"Left"):"ArrowRight"===t.code||"KeyD"===t.code?a(r,M).call(r,"Right"):"KeyR"===t.code&&(clearInterval(r.interval),r.init())}))}}),e(this,A,{writable:!0,value:function(){var t=0;"getGamepads"in window.navigator&&window.addEventListener("gamepadconnected",(function(){setInterval((function(){t+=10;var e,i=navigator.getGamepads(),n=!1;i[0].buttons.forEach((function(t,a){1===t.value&&(e=a,n=!0)})),n&&function(e){if(t>=250){switch(e){case 3:clearInterval(r.interval),r.init();break;case 12:a(r,M).call(r,"Up");break;case 13:a(r,M).call(r,"Down");break;case 14:a(r,M).call(r,"Left");break;case 15:a(r,M).call(r,"Right")}t=0}}(e)}),10)}))}}),e(this,I,{writable:!0,value:function(){var t=0,e=0,i=0,n=0;r.$MAP_WRAPPER.addEventListener("touchstart",(function(a){t=a.touches[0].pageX,e=a.touches[0].pageY})),r.$MAP_WRAPPER.addEventListener("touchend",(function(o){i=o.changedTouches[0].pageX,n=o.changedTouches[0].pageY;var c=i-t,s=n-e,l=Math.abs(c)>Math.abs(s),u=Math.abs(s)>Math.abs(c);c>0&&l?a(r,M).call(r,"Right"):c<0&&l?a(r,M).call(r,"Left"):s>0&&u?a(r,M).call(r,"Down"):s<0&&u&&a(r,M).call(r,"Up")}))}}),e(this,_,{writable:!0,value:function(){r.MATRIX_WIDTH=4,r.MATRIX_HEIGHT=4}}),e(this,E,{writable:!0,value:function(){r.$MAP_WRAPPER=document.querySelector(".game-2048__map-wrapper"),r.$SCORE_WRAPPER=document.querySelector(".game-2048__score"),r.$TIMER_WRAPPER=document.querySelector(".game-2048__timer"),r.$DIALOG_WRAPPER=document.querySelector(".game-2048__dialog")}}),e(this,W,{writable:!0,value:function(){a(r,T).call(r),a(r,A).call(r),a(r,I).call(r)}}),a(this,_).call(this),a(this,E).call(this),a(this,W).call(this),this.support=new l,this.init()})))})();