(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,i){for(var r=0;r<i.length;r++){var n=i[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,i){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===t(o)?o:String(o)),n)}var o}const i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e&&"number"==typeof e?e:0}var i,r;return i=t,(r=[{key:"value",get:function(){return this._value},set:function(t){t&&"number"==typeof t&&(this._value=t)}},{key:"increase",value:function(t){this._value+=t&&"number"==typeof t?t:1}},{key:"decrease",value:function(t){this._value-=t&&"number"==typeof t?t:1}},{key:"reset",value:function(){this._value=0}}])&&e(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),t}();function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===r(o)?o:String(o)),n)}var o}function o(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function a(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var s=new WeakSet,c=new WeakSet;function l(){this._timeStart=Date.now(),this._timeNow=this._timeStart,this._value="00:00"}function u(){this._timeNow=Date.now();var t=this._timeNow-this._timeStart,e=Math.floor(t/1e3),i=0;e>=60&&(e-=60*(i=Math.floor(e/60))),i=i<10?"0".concat(i):"".concat(i),e=e<10?"0".concat(e):"".concat(e),this._value="".concat(i,":").concat(e)}const h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,c),o(this,s),a(this,s,l).call(this)}var e,i;return e=t,(i=[{key:"value",get:function(){return a(this,c,u).call(this),this._value}},{key:"reset",value:function(){a(this,s,l).call(this)}}])&&n(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,n=function(t,e){if("object"!==f(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===f(n)?n:String(n)),r)}var n}const v=function(){function t(e,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.cost=r,this.draw()}var e,i;return e=t,(i=[{key:"draw",value:function(){document.querySelector('[x = "'.concat(this.x,'"][y = "').concat(this.y,'"]')).classList.add("tile","tile-"+this.cost),document.querySelector('[x = "'.concat(this.x,'"][y = "').concat(this.y,'"]')).innerText=this.cost}}])&&y(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function m(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d(r.key),r)}}function b(t,e,i){return e&&m(t.prototype,e),i&&m(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function w(t,e,i){return(e=d(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function d(t){var e=function(t,e){if("object"!==p(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===p(e)?e:String(e)}const S=b((function t(e,i,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),w(this,"generateMatrix",(function(t,e){for(var i=new Array,r=0;r<t;r++){i[r]=new Array;for(var n=0;n<e;n++)i[r][n]=0}return i})),w(this,"draw",(function(){n.$container.innerHTML="";var t=document.createElement("div");t.classList.add("map"),n.$container.appendChild(t);for(var e=n.matrix_height-1;e>=0;e--)for(var i=0;i<n.matrix_width;i++){var r=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",i),r.setAttribute("y",e),t.appendChild(r)}})),this.$container=e,this.matrix_width=i,this.matrix_height=r,this.matrix=this.generateMatrix(this.matrix_width,this.matrix_height),this.draw()}));function g(t,e){var i=t&&"number"==typeof t?t:0,r=e&&"number"==typeof e?e:0;return Math.floor(Math.random()*(r-i)+i)}function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function k(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,n=function(t,e){if("object"!==T(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===T(n)?n:String(n)),r)}var n}function I(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function _(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var E=new WeakSet,M=new WeakSet,A=new WeakSet,P=new WeakSet,R=new WeakSet,j=new WeakSet,H=new WeakSet,W=new WeakSet,x=new WeakSet,D=new WeakSet,L=new WeakSet,O=new WeakSet,X=new WeakSet;function G(){if(0!==_(this,M,$).call(this)){for(var t=new Array,e=0;e<this.MATRIX_WIDTH;e++)for(var i=0;i<this.MATRIX_HEIGHT;i++)0===this.tiles[e][i]&&t.push([e,i]);var r=g(0,t.length),n=2*g(1,3),o=t[r][0],a=t[r][1];this.tiles[o][a]=new v(o,a,n)}}function $(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var i=0;i<this.MATRIX_HEIGHT;i++)0===this.tiles[e][i]&&t++;return t}function C(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var i=0;i<this.MATRIX_HEIGHT;i++)0!==this.tiles[e][i]&&(t+=this.tiles[e][i].cost);this.score.value=t}function q(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var i=0;i<this.MATRIX_HEIGHT;i++)0===this.tiles[e][i]&&t++,i<3&&this.tiles[e][i].cost===this.tiles[e][i+1].cost&&t++,e<3&&this.tiles[e][i].cost===this.tiles[e+1][i].cost&&t++;0===t&&(this.$DIALOG.innerText="Game Over!",clearInterval(this.interval))}function U(){for(var t=0;t<this.MATRIX_WIDTH;t++)for(var e=0;e<this.MATRIX_HEIGHT;e++)0!==this.tiles[t][e]&&(this.tiles[t][e].x=t,this.tiles[t][e].y=e)}function K(t){for(var e=0;e<t.length;e++)0===t[e]&&(t.splice(e,1),e--);t.length>1&&t.forEach((function(e,i){void 0!==t[i-1]&&e.cost===t[i-1].cost&&(t[i-1].cost*=2,t.splice(i,1))}));for(var i=1;i<=4;i++)4!=t.length&&t.push(0);return t}function N(t){for(var e=0,i=0;i<=3;i++){var r=[],n=[];switch(t){case"Up":for(var o=3;o>=0;o--)r.push(this.tiles[i][o]),n.push(this.tiles[i][o]);break;case"Down":for(var a=0;a<=3;a++)r.push(this.tiles[i][a]),n.push(this.tiles[i][a]);break;case"Left":for(var s=0;s<=3;s++)r.push(this.tiles[s][i]),n.push(this.tiles[s][i]);break;case"Right":for(var c=3;c>=0;c--)r.push(this.tiles[c][i]),n.push(this.tiles[c][i])}r=_(this,j,K).call(this,r);for(var l=0;l<=r.length;l++)r[l]!==n[l]&&e++;switch(t){case"Up":for(var u=3;u>=0;u--)this.tiles[i][u]=r.shift();break;case"Down":for(var h=0;h<=3;h++)this.tiles[i][h]=r.shift();break;case"Left":for(var f=0;f<=3;f++)this.tiles[f][i]=r.shift();break;case"Right":for(var y=3;y>=0;y--)this.tiles[y][i]=r.shift()}}_(this,R,U).call(this),this.draw(),e>0&&_(this,E,G).call(this),this.draw(),_(this,A,C).call(this),_(this,P,q).call(this)}function z(){var t=this;window.addEventListener("keydown",(function(e){"ArrowUp"===e.code||"KeyW"===e.code?_(t,H,N).call(t,"Up"):"ArrowDown"===e.code||"KeyS"===e.code?_(t,H,N).call(t,"Down"):"ArrowLeft"===e.code||"KeyA"===e.code?_(t,H,N).call(t,"Left"):"ArrowRight"===e.code||"KeyD"===e.code?_(t,H,N).call(t,"Right"):"KeyR"===e.code&&(clearInterval(t.interval),t.init())}))}function Y(){var t=this,e=0;"getGamepads"in window.navigator&&window.addEventListener("gamepadconnected",(function(){setInterval((function(){e+=10;var i,r=navigator.getGamepads(),n=!1;r[0].buttons.forEach((function(t,e){1===t.value&&(i=e,n=!0)})),n&&function(i){if(e>=250){switch(i){case 3:clearInterval(t.interval),t.init();break;case 12:_(t,H,N).call(t,"Up");break;case 13:_(t,H,N).call(t,"Down");break;case 14:_(t,H,N).call(t,"Left");break;case 15:_(t,H,N).call(t,"Right")}e=0}}(i)}),10)}))}function B(){var t=this,e=0,i=0,r=0,n=0;this.$MAP.addEventListener("touchstart",(function(t){e=t.touches[0].pageX,i=t.touches[0].pageY})),this.$MAP.addEventListener("touchend",(function(o){r=o.changedTouches[0].pageX,n=o.changedTouches[0].pageY;var a=r-e,s=n-i,c=Math.abs(a)>Math.abs(s),l=Math.abs(s)>Math.abs(a);a>0&&c?_(t,H,N).call(t,"Right"):a<0&&c?_(t,H,N).call(t,"Left"):s>0&&l?_(t,H,N).call(t,"Down"):s<0&&l&&_(t,H,N).call(t,"Up")}))}function F(){this.MATRIX_WIDTH=4,this.MATRIX_HEIGHT=4}function J(){this.$MAP=document.querySelector("#map"),this.$SCORE=document.querySelector("#score"),this.$TIMER=document.querySelector("#timer"),this.$DIALOG=document.querySelector("#dialog")}function Q(){_(this,W,z).call(this),_(this,x,Y).call(this),_(this,D,B).call(this)}(new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),I(this,X),I(this,O),I(this,L),I(this,D),I(this,x),I(this,W),I(this,H),I(this,j),I(this,R),I(this,P),I(this,A),I(this,M),I(this,E),_(this,L,F).call(this),_(this,O,J).call(this),_(this,X,Q).call(this),this.init()}var e,r;return e=t,(r=[{key:"init",value:function(){this.map=new S(this.$MAP,this.MATRIX_WIDTH,this.MATRIX_HEIGHT),this.timer=new h,this.score=new i,this.tiles=this.map.matrix,_(this,E,G).call(this),_(this,E,G).call(this),_(this,A,C).call(this),this.draw(),this.$DIALOG.innerHTML="Get 2048!",this.interval=setInterval(this.draw,1e3)}},{key:"draw",value:function(){this.map.draw();for(var t=0;t<=3;t++)for(var e=0;e<=3;e++)0!==this.tiles[t][e]&&this.tiles[t][e].draw();this.$SCORE.innerText="Score: ".concat(this.score.value),this.$TIMER.innerText="Time: ".concat(this.timer.value)}}])&&k(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}())).start()})();