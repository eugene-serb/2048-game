(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:String(n)}function r(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var o=new WeakSet;function i(){this.interval=null,this.isGameOver=!1,this.isPaused=!1,this.canMove=!0}const a=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,n=o),n.add(e),r(this,o,i).call(this)}var n,a;return n=t,(a=[{key:"start",value:function(){this.isGameOver&&this.clear(),this.isPaused=!1,this.canMove=!0}},{key:"stop",value:function(){this.isPaused=!0,this.canMove=!1,clearTimeout(this.interval)}},{key:"setGameOver",value:function(){this.isGameOver=!0,this.stop()}},{key:"clear",value:function(){this.stop(),r(this,o,i).call(this)}}])&&e(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:String(e)}function l(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function f(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var h=new WeakSet,y=new WeakSet;function p(){this._timeStart=Date.now(),this._timeNow=this._timeStart,this._value="00:00"}function v(){this._timeNow=Date.now();var t=this._timeNow-this._timeStart,e=Math.floor(t/1e3),n=0;e>=60&&(e-=60*(n=Math.floor(e/60))),n=n<10?"0".concat(n):"".concat(n),e=e<10?"0".concat(e):"".concat(e),this._value="".concat(n,":").concat(e)}const m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,y),l(this,h),f(this,h,p).call(this)}var e,n;return e=t,(n=[{key:"value",get:function(){return f(this,y,v).call(this),this._value}},{key:"reset",value:function(){f(this,h,p).call(this)}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function w(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:String(e)}const S=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._value=e&&"number"==typeof e?e:0}var e,n;return e=t,(n=[{key:"value",get:function(){return this._value},set:function(t){t&&"number"==typeof t&&(this._value=t)}},{key:"increase",value:function(t){this._value+=t&&"number"==typeof t?t:1}},{key:"decrease",value:function(t){this._value-=t&&"number"==typeof t?t:1}},{key:"reset",value:function(){this._value=0}}])&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==g(e)?e:String(e)}function E(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function k(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var P=new WeakSet,R=new WeakSet,j=new WeakSet,O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),E(this,j),E(this,R),E(this,P),this._key=e,this._value=[],k(this,j,A).call(this)}var e,n;return e=t,n=[{key:"value",get:function(){return k(this,j,A).call(this),this._value}},{key:"add",value:function(t,e){if(t&&"number"==typeof t&&e&&"string"==typeof e){var n={date:Date.now(),score:t,time:e};this._value.push(n),k(this,P,x).call(this),k(this,R,I).call(this)}}},{key:"clean",value:function(){this._value=[],k(this,R,I).call(this)}}],n&&T(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(){this._value.sort((function(t,e){return t.score<e.score?1:t.score>e.score?-1:void 0}))}function I(){localStorage.setItem(this._key,JSON.stringify(this._value))}function A(){localStorage[this._key]?this._value=JSON.parse(localStorage[this._key]):this._value=[],k(this,P,x).call(this)}const M=O;function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,G(r.key),r)}}function D(t,e,n){return e&&W(t.prototype,e),n&&W(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function G(t){var e=function(t,e){if("object"!=C(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:String(e)}var L=new WeakSet;function H(){var t=this;window.addEventListener("keydown",(function(e){t._context.isGameOver||("ArrowLeft"===e.code||"KeyA"===e.code?t._context.moveToLeft():"ArrowUp"===e.code||"KeyW"===e.code?t._context.moveToUp():"ArrowRight"===e.code||"KeyD"===e.code?t._context.moveToRight():"ArrowDown"!==e.code&&"KeyS"!==e.code||t._context.moveToDown()),"KeyR"===e.code&&(t._context.clear(),t._context.start()),"KeyP"===e.code&&(t._context.isGameOver||(t._context.isPaused?t._context.start():t._context.stop()))}))}const N=D((function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n=this,r=L),r.add(n),this._context=e,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,L,H).call(this)}));function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,q(r.key),r)}}function K(t,e,n){return e&&U(t.prototype,e),n&&U(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function q(t){var e=function(t,e){if("object"!=$(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:String(e)}function z(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function Y(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var B=new WeakSet,J=new WeakSet,F=new WeakSet,Q=new WeakSet;function V(){Y(this,Q,et).call(this)&&(this.LISTENER_INTERRUPT=10,this.KEYPRESS_INTERRUPT=250,this._gamepadInterval=null,this._keypressCooldown=0,Y(this,J,Z).call(this))}function Z(){var t=this;window.addEventListener("gamepadconnected",(function(){t._gamepadInterval=setInterval((function(){t._keypressCooldown+=t.LISTENER_INTERRUPT;var e,n,r=(e=navigator.getGamepads(),n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,n)||function(t,e){if(t){if("string"==typeof t)return X(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=!1,i=null;r.buttons.forEach((function(t,e){1===t.value&&(i=e,o=!0)})),o&&Y(t,F,tt).call(t,i)}),t.LISTENER_INTERRUPT)}))}function tt(t){this._keypressCooldown>=this.KEYPRESS_INTERRUPT&&(12===t&&(this._context.moveToUp(),this._keypressCooldown=0),13===t&&(this._context.moveToDown(),this._keypressCooldown=0),14===t&&(this._context.moveToLeft(),this._keypressCooldown=0),15===t&&(this._context.moveToRight(),this._keypressCooldown=0),8===t&&(this._context.isPaused?(this._context.start(),this._keypressCooldown=0):(this._context.stop(),this._keypressCooldown=0)),9===t&&(this._context.clear(),this._context.start(),this._keypressCooldown=0))}function et(){return"getGamepads"in window.navigator}const nt=K((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),z(this,Q),z(this,F),z(this,J),z(this,B),this._context=e,Y(this,B,V).call(this)}));function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function it(t,e,n){return e&&ot(t.prototype,e),n&&ot(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function at(t){var e=function(t,e){if("object"!=rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rt(e)?e:String(e)}var st=new WeakSet;function ct(){var t=this,e=0,n=0;this._container.addEventListener("touchstart",(function(t){e=t.touches[0].pageX,n=t.touches[0].pageY})),this._container.addEventListener("touchend",(function(r){var o=r.changedTouches[0].pageX,i=r.changedTouches[0].pageY,a=o-e,s=i-n,c=Math.abs(a)>Math.abs(s),u=Math.abs(s)>Math.abs(a);a>0&&c?t._context.moveToRight():a<0&&c?t._context.moveToLeft():s>0&&u?t._context.moveToDown():s<0&&u&&t._context.moveToUp()}))}const ut=it((function t(e,n){var r,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(r=this,o=st),o.add(r),this._context=e,this._container=n,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(this,st,ct).call(this)}));function lt(t,e){var n=t&&"number"==typeof t?t:0,r=e&&"number"==typeof e?e:0;return Math.floor(Math.random()*(r-n)+n)}function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vt(r.key),r)}}function yt(t,e,n){return e&&ht(t.prototype,e),n&&ht(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pt(t,e,n){return(e=vt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vt(t){var e=function(t,e){if("object"!=ft(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:String(e)}const mt=yt((function t(e,n,r){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),pt(this,"generateMatrix",(function(t,e){for(var n=new Array,r=0;r<t;r++){n[r]=new Array;for(var o=0;o<e;o++)n[r][o]=0}return n})),pt(this,"draw",(function(){o.$container.innerHTML="";var t=document.createElement("div");t.classList.add("map"),o.$container.appendChild(t);for(var e=o.matrix_height-1;e>=0;e--)for(var n=0;n<o.matrix_width;n++){var r=document.createElement("div");r.classList.add("cell"),r.setAttribute("x",n),r.setAttribute("y",e),t.appendChild(r)}})),this.$container=e,this.matrix_width=n,this.matrix_height=r,this.matrix=this.generateMatrix(this.matrix_width,this.matrix_height),this.draw()}));function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t,e){if("object"!=bt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=bt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bt(e)?e:String(e)}const St=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.cost=r,this.draw()}var e,n;return e=t,(n=[{key:"draw",value:function(){document.querySelector('[x = "'.concat(this.x,'"][y = "').concat(this.y,'"]')).classList.add("tile","tile-"+this.cost),document.querySelector('[x = "'.concat(this.x,'"][y = "').concat(this.y,'"]')).innerText=this.cost}}])&&dt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_t(r.key),r)}}function _t(t){var e=function(t,e){if("object"!=gt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(e)?e:String(e)}function Et(t,e,n){return e=jt(e),function(t,e){if(e&&("object"===gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Pt(t)}(t,kt()?Reflect.construct(e,n||[],jt(t).constructor):e.apply(t,n))}function kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(kt=function(){return!!t})()}function Pt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rt(){return Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Rt.apply(this,arguments)}function jt(t){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jt(t)}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}function xt(t,e){!function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function It(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var At=new WeakSet,Mt=new WeakSet,Ct=new WeakSet,Wt=new WeakSet,Dt=new WeakSet,Gt=new WeakSet,Lt=new WeakSet,Ht=new WeakSet,Nt=new WeakSet,$t=new WeakSet,Xt=new WeakSet,Ut=new WeakSet,Kt=new WeakSet,qt=function(t){function e(t){var n,r,o,i,a,s,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xt(Pt(c=Et(this,e)),Kt),xt(Pt(c),Ut),xt(Pt(c),Xt),xt(Pt(c),$t),xt(Pt(c),Nt),xt(Pt(c),Ht),xt(Pt(c),Lt),xt(Pt(c),Gt),xt(Pt(c),Dt),xt(Pt(c),Wt),xt(Pt(c),Ct),xt(Pt(c),Mt),xt(Pt(c),At),c._params=t,c.SPEED_RATE=null!==(n=c._params)&&void 0!==n&&n.speedRate&&"number"==typeof(null===(r=c._params)||void 0===r?void 0:r.speedRate)?null===(o=c._params)||void 0===o?void 0:o.speedRate:1e3,c.KEY_RATING=null!==(i=c._params)&&void 0!==i&&i.keyRating&&"string"==typeof(null===(a=c._params)||void 0===a?void 0:a.keyRating)?null===(s=c._params)||void 0===s?void 0:s.keyRating:"es:2048",It(Pt(c),Ut,re).call(Pt(c)),It(Pt(c),Xt,ne).call(Pt(c)),It(Pt(c),Kt,oe).call(Pt(c)),It(Pt(c),At,zt).call(Pt(c)),c}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(e,t),n=e,r=[{key:"moveToLeft",value:function(){It(this,$t,ee).call(this,"Left")}},{key:"moveToUp",value:function(){It(this,$t,ee).call(this,"Up")}},{key:"moveToRight",value:function(){It(this,$t,ee).call(this,"Right")}},{key:"moveToDown",value:function(){It(this,$t,ee).call(this,"Down")}},{key:"start",value:function(){Rt(jt(e.prototype),"start",this).call(this),this.interval=setInterval(It(this,Mt,Yt).bind(this),this.SPEED_RATE)}},{key:"setGameOver",value:function(){Rt(jt(e.prototype),"setGameOver",this).call(this);var t=this.score.value,n=this.timer.value;this.rating.add(t,n),this.drawRating()}},{key:"clear",value:function(){Rt(jt(e.prototype),"clear",this).call(this),It(this,At,zt).call(this)}},{key:"drawRating",value:function(){this.$RATING.innerHTML="";for(var t=this.rating.value,e=0;e<t.length&&e<10;e++){var n=document.createElement("tr"),r=document.createElement("td"),o=document.createElement("td"),i=document.createElement("td"),a=document.createElement("td"),s=new Date(t[e].date);r.innerText=e+1,o.innerText=t[e].score,i.innerText=t[e].time,a.innerText=s.toLocaleDateString(),n.append(r,o,i,a),this.$RATING.appendChild(n)}}}],r&&Tt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}(a);function zt(){this.rating=new M(this.KEY_RATING),this.drawRating(),this.$DIALOG.innerHTML="Get 2048!",this.timer=new m,this.score=new S,this.drawer=new mt(this.$MAP,this.MATRIX_WIDTH,this.MATRIX_HEIGHT),this.tiles=this.drawer.matrix,It(this,Wt,Jt).call(this),It(this,Wt,Jt).call(this),It(this,Gt,Qt).call(this),It(this,Ct,Bt).call(this)}function Yt(){It(this,Ct,Bt).call(this)}function Bt(){this.drawer.draw();for(var t=0;t<=3;t++)for(var e=0;e<=3;e++)0!==this.tiles[t][e]&&this.tiles[t][e].draw();this.$SCORE.innerText="Score: ".concat(this.score.value),this.$TIMER.innerText="Time: ".concat(this.timer.value)}function Jt(){if(0!==It(this,Dt,Ft).call(this)){for(var t=new Array,e=0;e<this.MATRIX_WIDTH;e++)for(var n=0;n<this.MATRIX_HEIGHT;n++)0===this.tiles[e][n]&&t.push([e,n]);var r=lt(0,t.length),o=2*lt(1,3),i=t[r][0],a=t[r][1];this.tiles[i][a]=new St(i,a,o)}}function Ft(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var n=0;n<this.MATRIX_HEIGHT;n++)0===this.tiles[e][n]&&t++;return t}function Qt(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var n=0;n<this.MATRIX_HEIGHT;n++)0!==this.tiles[e][n]&&(t+=this.tiles[e][n].cost);this.score.value=t}function Vt(){for(var t=0,e=0;e<this.MATRIX_WIDTH;e++)for(var n=0;n<this.MATRIX_HEIGHT;n++)0===this.tiles[e][n]&&t++,n<3&&this.tiles[e][n].cost===this.tiles[e][n+1].cost&&t++,e<3&&this.tiles[e][n].cost===this.tiles[e+1][n].cost&&t++;0===t&&(this.$DIALOG.innerText="Game Over!",this.setGameOver())}function Zt(){for(var t=0;t<this.MATRIX_WIDTH;t++)for(var e=0;e<this.MATRIX_HEIGHT;e++)0!==this.tiles[t][e]&&(this.tiles[t][e].x=t,this.tiles[t][e].y=e)}function te(t){for(var e=0;e<t.length;e++)0===t[e]&&(t.splice(e,1),e--);t.length>1&&t.forEach((function(e,n){void 0!==t[n-1]&&e.cost===t[n-1].cost&&(t[n-1].cost*=2,t.splice(n,1))}));for(var n=1;n<=4;n++)4!=t.length&&t.push(0);return t}function ee(t){for(var e=0,n=0;n<=3;n++){var r=[],o=[];switch(t){case"Up":for(var i=3;i>=0;i--)r.push(this.tiles[n][i]),o.push(this.tiles[n][i]);break;case"Down":for(var a=0;a<=3;a++)r.push(this.tiles[n][a]),o.push(this.tiles[n][a]);break;case"Left":for(var s=0;s<=3;s++)r.push(this.tiles[s][n]),o.push(this.tiles[s][n]);break;case"Right":for(var c=3;c>=0;c--)r.push(this.tiles[c][n]),o.push(this.tiles[c][n])}r=It(this,Nt,te).call(this,r);for(var u=0;u<=r.length;u++)r[u]!==o[u]&&e++;switch(t){case"Up":for(var l=3;l>=0;l--)this.tiles[n][l]=r.shift();break;case"Down":for(var f=0;f<=3;f++)this.tiles[n][f]=r.shift();break;case"Left":for(var h=0;h<=3;h++)this.tiles[h][n]=r.shift();break;case"Right":for(var y=3;y>=0;y--)this.tiles[y][n]=r.shift()}}It(this,Ht,Zt).call(this),It(this,Ct,Bt).call(this),e>0&&It(this,Wt,Jt).call(this),It(this,Ct,Bt).call(this),It(this,Gt,Qt).call(this),It(this,Lt,Vt).call(this)}function ne(){this.MATRIX_WIDTH=4,this.MATRIX_HEIGHT=4}function re(){this.$MAP=document.querySelector("#map"),this.$SCORE=document.querySelector("#score"),this.$TIMER=document.querySelector("#timer"),this.$DIALOG=document.querySelector("#dialog"),this.$RATING=document.querySelector("#rating")}function oe(){this._keyboard=new N(this),this._gamepads=new nt(this),this._touchscreen=new ut(this,this.$MAP)}new qt({speedRate:200,keyRating:"es:2048"}).start()})();